import{r as d,R,j as a,h as L}from"./chunk-Cmr4nUfp.js";function j(...e){return e.length===1&&e[0]?e[0]:n=>{for(let t of e)typeof t=="function"?t(n):t!=null&&(t.current=n)}}const E=()=>document.readyState==="complete"||document.readyState==="interactive",l=[];let h=!1;const g=()=>{if(E()===!1){console.error("DOMContentLoaded event has not been fired yet");return}if(h)return;h=!0;const e=document.addEventListener,n=window.addEventListener,t=new Event("DOMContentLoaded"),r=new Event("load");window.addEventListener=(o,c,s)=>{o==="DOMContentLoaded"?l.push(()=>c.call(window,t)):(o==="load"&&l.push(()=>c.call(window,r)),n.call(window,o,c,s))},document.addEventListener=(o,c,s)=>{o==="DOMContentLoaded"?l.push(()=>c.call(document,t)):e.call(document,o,c,s)}},S=()=>{for(const e of l)e();l.length=0},b={scriptTestIdPrefix:"client-"},O=e=>new Promise((n,t)=>{const r=document.createElement("script"),o=e.hasAttribute("src"),c=e.type==="module";for(const{name:s,value:i}of e.attributes)r.setAttribute(s,i);if(r.dataset.testid!==void 0&&(r.dataset.testid=`${b.scriptTestIdPrefix}${r.dataset.testid}`),o)r.addEventListener("load",()=>{n()}),r.addEventListener("error",t);else{if(c){const s=new Blob([e.innerText],{type:"text/javascript"}),i=URL.createObjectURL(s);import(i).then(n).catch(t).finally(()=>{URL.revokeObjectURL(i)});return}r.textContent=e.innerText}e.replaceWith(r),o===!1&&n()}),u=[];let f=!1;const C=async e=>{if(u.push(...e),await Promise.resolve(),!f){for(g(),f=!0;u.length>0;)await u.shift()();S(),f=!1}},M=e=>{const n=e.querySelectorAll("script"),t=[],r=[];n.forEach(o=>{(o.hasAttribute("async")?r:t).push(()=>O(o))});for(const o of r)o();C(t)},T=e=>{const{code:n,innerRef:t,...r}=e;return a.jsx("div",{ref:t,...r,style:{display:"block",padding:20},children:'Open the "Settings" panel to insert HTML code.'})},x=()=>d.useSyncExternalStore(()=>()=>{},()=>!1,()=>!0),p=e=>{if(!x())return e.children},m=e=>{const{code:n,innerRef:t,...r}=e,o=d.useRef(null),c=d.useRef(!0),s=d.useMemo(()=>({__html:n??""}),[n]);return d.useEffect(()=>{const i=o.current;i&&c.current&&(c.current=!1,M(i))},[]),a.jsx("div",{...r,ref:j(t,o),dangerouslySetInnerHTML:s})},v=e=>{const{code:n,innerRef:t,...r}=e;return a.jsx("div",{...r,ref:t,dangerouslySetInnerHTML:{__html:n??""}})},$=v,P=d.forwardRef((e,n)=>{const{code:t,executeScriptOnCanvas:r,clientOnly:o,children:c,...s}=e,{renderer:i}=d.useContext(R),w=x(),[y]=d.useState(w);return t===void 0||String(t).trim().length===0?a.jsx(T,{innerRef:n,...s}):y?o!==!0?a.jsx(v,{innerRef:n,code:t,...s}):a.jsx(p,{children:a.jsx(m,{innerRef:n,code:t,...s})}):i==="canvas"&&r!==!0?a.jsx(p,{children:a.jsx($,{innerRef:n,code:t,...s})}):a.jsx(p,{children:a.jsx(m,{innerRef:n,code:t,...s},t)})});P.displayName="HtmlEmbed";const H="div",I=d.forwardRef(({tag:e,...n},t)=>{const r=L(n)??e??H;return d.createElement(r,{...n,ref:t})});I.displayName="Text";export{P,I as n};
